DROP TABLE IF EXISTS users CASCADE;
DROP TABLE IF EXISTS items CASCADE;
DROP TABLE IF EXISTS requests CASCADE;
DROP TABLE IF EXISTS bookings CASCADE;
DROP TABLE IF EXISTS comments CASCADE;

CREATE TABLE IF NOT EXISTS USERS (
id BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
name VARCHAR(255) NOT NULL,
email VARCHAR(512) NOT NULL UNIQUE
);

CREATE TABLE if NOT EXISTS REQUESTS (
id BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
description VARCHAR NOT NULL,
requester_id BIGINT NOT NULL REFERENCES USERS (id) ON DELETE CASCADE,
created TIMESTAMP WITHOUT TIME ZONE
);

CREATE TABLE IF NOT EXISTS ITEMS (
id BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
name VARCHAR(255) NOT NULL,
description VARCHAR NOT NULL,
available BOOLEAN NOT NULL,
owner_id BIGINT NOT NULL REFERENCES USERS (id) ON DELETE CASCADE,
request_id BIGINT REFERENCES REQUESTS (id) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS BOOKINGS (
id BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
start_date TIMESTAMP WITHOUT TIME ZONE NOT NULL,
end_date TIMESTAMP WITHOUT TIME ZONE NOT NULL,
item_id BIGINT NOT NULL REFERENCES ITEMS (id) ON DELETE CASCADE,
booker_id BIGINT NOT NULL REFERENCES USERS (id) ON DELETE CASCADE,
status VARCHAR
);

CREATE TABLE IF NOT EXISTS COMMENTS (
id BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
text VARCHAR NOT NULL,
item_id BIGINT NOT NULL REFERENCES ITEMS (id) ON DELETE CASCADE,
author_id BIGINT NOT NULL REFERENCES USERS (id) ON DELETE CASCADE,
created TIMESTAMP WITHOUT TIME ZONE
);